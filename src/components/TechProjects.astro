---
// Tech & Projects - Premium holographic section combining Skills, GitHub Stats, and Projects
---

<section id="tech" class="tech-section section section-bg">
    <!-- Background -->
    <div class="tech-bg">
        <div class="tech-grid-pattern"></div>
        <div class="tech-glow-orb"></div>
    </div>

    <div class="container">
        <!-- Section Header -->
        <div class="section-header">
            <div class="section-badge animate-item" data-delay="0">
                <i class="fas fa-code"></i>
                <span>Tech & Projects</span>
            </div>
            <h2 class="section-title animate-item gradient-text-animated" data-delay="100">Skills & Open Source</h2>
            <p class="section-subtitle animate-item" data-delay="200">Technologies I work with and projects I've built</p>
        </div>

        <!-- Loading State -->
        <div id="tech-loading" class="loading-state">
            <div class="loading-cube">
                <div class="cube-face face-front"></div>
                <div class="cube-face face-back"></div>
                <div class="cube-face face-left"></div>
                <div class="cube-face face-right"></div>
                <div class="cube-face face-top"></div>
                <div class="cube-face face-bottom"></div>
            </div>
            <p class="loading-text">Fetching data<span class="loading-dots"></span></p>
        </div>

        <!-- Main Content -->
        <div id="tech-content" class="tech-content" style="display: none;">

            <!-- Stats Row - Ultra Premium Holographic Cards -->
            <div class="stats-row animate-item" data-delay="300">
                <div class="stat-card stat-repos" data-stat="repos">
                    <div class="stat-hologram"></div>
                    <div class="stat-scanline"></div>
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon-ring"></div>
                        <div class="stat-icon-core">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <div class="stat-icon-particles"></div>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-repos">0</span>
                        <span class="stat-label">Repositories</span>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" style="--progress: 100%"></div>
                        </div>
                    </div>
                    <div class="stat-corner stat-corner-tl"></div>
                    <div class="stat-corner stat-corner-tr"></div>
                    <div class="stat-corner stat-corner-bl"></div>
                    <div class="stat-corner stat-corner-br"></div>
                </div>
                <div class="stat-card stat-stars" data-stat="stars">
                    <div class="stat-hologram"></div>
                    <div class="stat-scanline"></div>
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon-ring"></div>
                        <div class="stat-icon-core">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-icon-particles"></div>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-stars">0</span>
                        <span class="stat-label">Stars Earned</span>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" style="--progress: 40%"></div>
                        </div>
                    </div>
                    <div class="stat-corner stat-corner-tl"></div>
                    <div class="stat-corner stat-corner-tr"></div>
                    <div class="stat-corner stat-corner-bl"></div>
                    <div class="stat-corner stat-corner-br"></div>
                </div>
                <div class="stat-card stat-followers" data-stat="followers">
                    <div class="stat-hologram"></div>
                    <div class="stat-scanline"></div>
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon-ring"></div>
                        <div class="stat-icon-core">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-icon-particles"></div>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-followers">0</span>
                        <span class="stat-label">Followers</span>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" style="--progress: 60%"></div>
                        </div>
                    </div>
                    <div class="stat-corner stat-corner-tl"></div>
                    <div class="stat-corner stat-corner-tr"></div>
                    <div class="stat-corner stat-corner-bl"></div>
                    <div class="stat-corner stat-corner-br"></div>
                </div>
                <div class="stat-card stat-commits" data-stat="commits">
                    <div class="stat-hologram"></div>
                    <div class="stat-scanline"></div>
                    <div class="stat-icon-wrapper">
                        <div class="stat-icon-ring"></div>
                        <div class="stat-icon-core">
                            <i class="fas fa-code-commit"></i>
                        </div>
                        <div class="stat-icon-particles"></div>
                    </div>
                    <div class="stat-info">
                        <span class="stat-value" id="stat-commits">0</span>
                        <span class="stat-label">Total Commits</span>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" style="--progress: 75%"></div>
                        </div>
                    </div>
                    <div class="stat-corner stat-corner-tl"></div>
                    <div class="stat-corner stat-corner-tr"></div>
                    <div class="stat-corner stat-corner-bl"></div>
                    <div class="stat-corner stat-corner-br"></div>
                </div>
            </div>

            <!-- Two Column Layout - Premium Design -->
            <div class="two-columns animate-item" data-delay="400">
                <!-- Languages Card - Enhanced -->
                <div class="column-card languages-card">
                    <div class="card-hologram"></div>
                    <div class="card-header">
                        <div class="card-icon-3d">
                            <div class="icon-cube">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="icon-orbit"></div>
                        </div>
                        <div class="card-title-wrapper">
                            <h3 class="card-title">Top Languages</h3>
                            <span class="card-subtitle">Code distribution across projects</span>
                        </div>
                    </div>
                    <div id="languages-list" class="languages-list"></div>
                    <div class="languages-bar-container">
                        <div id="languages-bar" class="languages-bar"></div>
                        <div class="bar-reflection"></div>
                    </div>
                    <div class="card-decoration-line"></div>
                </div>

                <!-- Tech Stack Card - Enhanced -->
                <div class="column-card stack-card">
                    <div class="card-hologram"></div>
                    <div class="card-header">
                        <div class="card-icon-3d">
                            <div class="icon-cube">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="icon-orbit"></div>
                        </div>
                        <div class="card-title-wrapper">
                            <h3 class="card-title">Tech Stack</h3>
                            <span class="card-subtitle">Technologies & tools I work with</span>
                        </div>
                    </div>
                    <div class="tech-stack">
                        <div class="tech-category" data-category="backend">
                            <div class="category-header">
                                <div class="category-icon-wrapper">
                                    <span class="category-icon"><i class="fas fa-server"></i></span>
                                    <span class="category-pulse"></span>
                                </div>
                                <span class="category-label">Backend</span>
                                <span class="category-count">4</span>
                            </div>
                            <div class="tech-tags">
                                <div class="tech-tag" data-tech="java">
                                    <span class="tech-tag-icon"><i class="fab fa-java"></i></span>
                                    <span class="tech-tag-name">Java 17+</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="spring">
                                    <span class="tech-tag-icon"><i class="fas fa-leaf"></i></span>
                                    <span class="tech-tag-name">Spring Boot</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="quarkus">
                                    <span class="tech-tag-icon"><i class="fas fa-bolt"></i></span>
                                    <span class="tech-tag-name">Quarkus</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="micro">
                                    <span class="tech-tag-icon"><i class="fas fa-cubes"></i></span>
                                    <span class="tech-tag-name">Microservices</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                            </div>
                        </div>
                        <div class="tech-category" data-category="devops">
                            <div class="category-header">
                                <div class="category-icon-wrapper">
                                    <span class="category-icon"><i class="fas fa-cloud"></i></span>
                                    <span class="category-pulse"></span>
                                </div>
                                <span class="category-label">DevOps & Cloud</span>
                                <span class="category-count">4</span>
                            </div>
                            <div class="tech-tags">
                                <div class="tech-tag" data-tech="docker">
                                    <span class="tech-tag-icon"><i class="fab fa-docker"></i></span>
                                    <span class="tech-tag-name">Docker</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="k8s">
                                    <span class="tech-tag-icon"><i class="fas fa-dharmachakra"></i></span>
                                    <span class="tech-tag-name">Kubernetes</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="aws">
                                    <span class="tech-tag-icon"><i class="fab fa-aws"></i></span>
                                    <span class="tech-tag-name">AWS</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="cicd">
                                    <span class="tech-tag-icon"><i class="fas fa-sync-alt"></i></span>
                                    <span class="tech-tag-name">CI/CD</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                            </div>
                        </div>
                        <div class="tech-category" data-category="database">
                            <div class="category-header">
                                <div class="category-icon-wrapper">
                                    <span class="category-icon"><i class="fas fa-database"></i></span>
                                    <span class="category-pulse"></span>
                                </div>
                                <span class="category-label">Database</span>
                                <span class="category-count">3</span>
                            </div>
                            <div class="tech-tags">
                                <div class="tech-tag" data-tech="postgres">
                                    <span class="tech-tag-icon"><i class="fas fa-database"></i></span>
                                    <span class="tech-tag-name">PostgreSQL</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="mongo">
                                    <span class="tech-tag-icon"><i class="fas fa-leaf"></i></span>
                                    <span class="tech-tag-name">MongoDB</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                                <div class="tech-tag" data-tech="redis">
                                    <span class="tech-tag-icon"><i class="fas fa-bolt"></i></span>
                                    <span class="tech-tag-name">Redis</span>
                                    <span class="tech-tag-glow"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-decoration-line"></div>
                </div>
            </div>

            <!-- Projects Grid -->
            <div class="projects-section animate-item" data-delay="500">
                <div class="section-header-small">
                    <div class="header-line"></div>
                    <h3>
                        <i class="fas fa-rocket"></i>
                        Featured Projects
                    </h3>
                    <div class="header-line"></div>
                </div>
                <div id="projects-grid" class="projects-grid">
                    <!-- Skeleton loaders shown while loading -->
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-preview">
                            <div class="skeleton-icon"></div>
                            <div class="skeleton-badge"></div>
                        </div>
                        <div class="skeleton-content">
                            <div class="skeleton-title"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-desc"></div>
                            <div class="skeleton-tags">
                                <div class="skeleton-tag"></div>
                                <div class="skeleton-tag"></div>
                            </div>
                            <div class="skeleton-footer">
                                <div class="skeleton-stat"></div>
                                <div class="skeleton-stat"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="https://github.com/carlosorbegoso?tab=repositories" target="_blank" rel="noopener noreferrer" class="view-all-btn">
                    <span class="btn-bg"></span>
                    <span class="btn-content">
                        <span>View All on GitHub</span>
                        <i class="fas fa-arrow-right"></i>
                    </span>
                </a>
            </div>

            <!-- Contribution Graph -->
            <div class="contributions-section animate-item" data-delay="600">
                <div class="contributions-header">
                    <h3>
                        <i class="fas fa-fire-alt"></i>
                        Activity
                    </h3>
                    <div class="streak-badge" id="streak-badge">
                        <div class="streak-fire">
                            <i class="fas fa-fire"></i>
                        </div>
                        <span id="current-streak">0</span>
                        <span class="streak-label">day streak</span>
                    </div>
                </div>
                <div id="contribution-graph" class="contribution-graph"></div>
                <div class="contribution-legend">
                    <span>Less</span>
                    <div class="legend-squares">
                        <span class="legend-square level-0"></span>
                        <span class="legend-square level-1"></span>
                        <span class="legend-square level-2"></span>
                        <span class="legend-square level-3"></span>
                        <span class="legend-square level-4"></span>
                    </div>
                    <span>More</span>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    import { getGitHubStats, languageColors } from '../scripts/services/github-api.js';

    function animateNumber(el: HTMLElement | null, target: number, duration = 1500): void {
        if (!el) return;
        const start = performance.now();
        function update(now: number) {
            const progress = Math.min((now - start) / duration, 1);
            const ease = 1 - Math.pow(1 - progress, 3);
            el!.textContent = Math.floor(target * ease).toString();
            if (progress < 1) requestAnimationFrame(update);
        }
        requestAnimationFrame(update);
    }

    function renderLanguages(languages: Array<{language: string, percentage: number}>): void {
        const list = document.getElementById('languages-list');
        const bar = document.getElementById('languages-bar');
        if (!list) return;

        list.innerHTML = languages.slice(0, 6).map(({ language, percentage }) => {
            const color = (languageColors as Record<string, string>)[language] || '#8b8b8b';
            return `
                <div class="language-item" style="--lang-color: ${color}">
                    <span class="lang-dot" style="background: ${color}"></span>
                    <span class="lang-name">${language}</span>
                    <span class="lang-percent">${percentage}%</span>
                </div>
            `;
        }).join('');

        if (bar) {
            bar.innerHTML = languages.map(({ language, percentage }) => {
                const color = (languageColors as Record<string, string>)[language] || '#8b8b8b';
                return `<div class="lang-bar-segment" style="width: ${percentage}%; background: ${color}; color: ${color}"></div>`;
            }).join('');
        }
    }

    interface RepoData {
        name: string;
        description: string | null;
        url: string;
        language: string | null;
        stars: number;
        forks: number;
        topics?: string[];
        updatedAt?: string;
        homepage?: string | null;
    }

    function getProjectIcon(repo: RepoData): string {
        const name = repo.name.toLowerCase();
        const lang = repo.language?.toLowerCase() || '';
        const topics = (repo.topics || []).map(t => t.toLowerCase());

        if (topics.includes('api') || name.includes('api')) return 'fas fa-plug';
        if (topics.includes('mobile') || lang === 'kotlin' || lang === 'swift') return 'fas fa-mobile-alt';
        if (topics.includes('web') || topics.includes('frontend')) return 'fas fa-globe';
        if (topics.includes('docker') || topics.includes('kubernetes')) return 'fab fa-docker';
        if (topics.includes('ai') || topics.includes('ml') || topics.includes('machine-learning')) return 'fas fa-brain';
        if (lang === 'java' || topics.includes('spring')) return 'fab fa-java';
        if (lang === 'python') return 'fab fa-python';
        if (lang === 'typescript' || lang === 'javascript') return 'fab fa-js-square';
        if (lang === 'go') return 'fab fa-golang';
        if (lang === 'rust') return 'fab fa-rust';
        if (name.includes('workflow') || name.includes('ci') || name.includes('cd')) return 'fas fa-cogs';
        if (lang === 'shell') return 'fas fa-terminal';
        if (topics.includes('database') || topics.includes('sql')) return 'fas fa-database';

        return 'fas fa-code';
    }

    function getProjectType(repo: RepoData): string {
        const lang = repo.language?.toLowerCase() || '';
        const topics = (repo.topics || []).map(t => t.toLowerCase());
        const name = repo.name.toLowerCase();

        if (topics.includes('fullstack') || topics.includes('full-stack')) return 'Full Stack';
        if (topics.includes('frontend') || lang === 'vue' || lang === 'svelte') return 'Frontend';
        if (topics.includes('backend') || lang === 'java' || lang === 'kotlin' || lang === 'go') return 'Backend';
        if (topics.includes('mobile') || lang === 'swift' || lang === 'dart') return 'Mobile';
        if (topics.includes('devops') || topics.includes('ci-cd') || topics.includes('docker')) return 'DevOps';
        if (topics.includes('api') || name.includes('api')) return 'API';
        if (topics.includes('cli') || lang === 'shell') return 'CLI Tool';
        if (topics.includes('library') || topics.includes('package')) return 'Library';
        if (lang === 'typescript' || lang === 'javascript') return 'Web App';
        if (lang === 'python') return 'Python';

        return 'Project';
    }

    function formatTimeAgo(dateString: string | undefined): string {
        if (!dateString) return '';
        const date = new Date(dateString);
        const now = new Date();
        const diffMs = now.getTime() - date.getTime();
        const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

        if (diffDays === 0) return 'today';
        if (diffDays === 1) return 'yesterday';
        if (diffDays < 7) return `${diffDays}d ago`;
        if (diffDays < 30) return `${Math.floor(diffDays / 7)}w ago`;
        if (diffDays < 365) return `${Math.floor(diffDays / 30)}mo ago`;
        return `${Math.floor(diffDays / 365)}y ago`;
    }

    // Generate smart description based on repo characteristics
    function getSmartDescription(repo: RepoData): string {
        if (repo.description) return repo.description;

        const lang = repo.language?.toLowerCase() || '';
        const name = repo.name.toLowerCase();
        const topics = (repo.topics || []).map(t => t.toLowerCase());

        // Generate context-aware descriptions
        if (name.includes('poc') || topics.includes('poc')) {
            return `Proof of concept exploring ${lang || 'new technologies'} capabilities and patterns.`;
        }
        if (name.includes('template') || topics.includes('template')) {
            return `Reusable template for ${lang || 'development'} projects with best practices.`;
        }
        if (name.includes('workflow') || topics.includes('ci-cd')) {
            return `Automation workflows and CI/CD pipeline configurations.`;
        }
        if (topics.includes('api') || name.includes('api')) {
            return `RESTful API service built with ${lang || 'modern'} technologies.`;
        }
        if (lang === 'java' || lang === 'kotlin') {
            return `Enterprise-grade ${lang} application with modern architecture.`;
        }
        if (lang === 'javascript' || lang === 'typescript') {
            return `Modern web application built with ${lang}.`;
        }
        if (lang === 'shell') {
            return `Shell scripts and automation utilities for DevOps workflows.`;
        }
        if (name.includes('page') || name.includes('portfolio')) {
            return `Personal portfolio showcasing projects and skills.`;
        }

        return `A ${lang || 'software'} project exploring new concepts and patterns.`;
    }

    function renderProjects(repos: Array<RepoData>): void {
        const grid = document.getElementById('projects-grid');
        if (!grid) return;

        grid.innerHTML = repos.slice(0, 6).map(repo => {
            const langColor = repo.language ? (languageColors as Record<string, string>)[repo.language] || '#8b8b8b' : '#8b8b8b';
            const icon = getProjectIcon(repo);
            const type = getProjectType(repo);
            const timeAgo = formatTimeAgo(repo.updatedAt);
            const topics = repo.topics || [];
            const description = getSmartDescription(repo);
            const hasDescription = !!repo.description;

            // Format project name for display
            const displayName = repo.name
                .replace(/-/g, ' ')
                .replace(/_/g, ' ')
                .split(' ')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');

            return `
                <a href="${repo.url}" target="_blank" rel="noopener noreferrer" class="project-card">
                    <div class="shimmer"></div>
                    <div class="project-preview">
                        <div class="project-preview-pattern"></div>
                        <div class="project-preview-icon">
                            <i class="${icon}"></i>
                        </div>
                        <span class="project-type-badge">${type}</span>
                        ${repo.homepage ? `
                            <a href="${repo.homepage}" target="_blank" rel="noopener noreferrer" class="project-live-btn" title="Live Demo" onclick="event.stopPropagation()">
                                <i class="fas fa-external-link-alt"></i>
                                <span>Live</span>
                            </a>
                        ` : ''}
                    </div>
                    <div class="project-content">
                        <div class="project-header">
                            <span class="project-name">${displayName}</span>
                            ${repo.language ? `
                                <span class="project-lang-badge">
                                    <span class="lang-dot" style="background: ${langColor}; color: ${langColor}"></span>
                                    ${repo.language}
                                </span>
                            ` : ''}
                        </div>
                        <p class="project-desc ${!hasDescription ? 'auto-desc' : ''}">${description}</p>
                        ${topics.length > 0 ? `
                            <div class="project-tech-tags">
                                ${topics.slice(0, 4).map(topic => `
                                    <span class="project-tech-tag">${topic}</span>
                                `).join('')}
                            </div>
                        ` : ''}
                        <div class="project-stats-footer">
                            <span class="project-stat stars">
                                <i class="fas fa-star"></i>
                                ${repo.stars}
                            </span>
                            <span class="project-stat forks">
                                <i class="fas fa-code-branch"></i>
                                ${repo.forks}
                            </span>
                            ${timeAgo ? `
                                <span class="project-updated">
                                    <i class="fas fa-clock"></i>
                                    ${timeAgo}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                </a>
            `;
        }).join('');
    }

    function renderContributions(data: Array<Array<{date: string, count: number, level: number}>> | null): void {
        const container = document.getElementById('contribution-graph');
        if (!container || !data) return;

        const weeks = window.innerWidth < 480 ? 13 : window.innerWidth < 768 ? 26 : 52;
        const display = data.slice(-weeks);

        container.innerHTML = display.map(week => `
            <div class="contribution-week">
                ${week.map(day => `
                    <div class="contribution-day level-${day.level}" title="${day.date}: ${day.count} contributions"></div>
                `).join('')}
            </div>
        `).join('');
    }

    async function loadData(): Promise<void> {
        const loading = document.getElementById('tech-loading');
        const content = document.getElementById('tech-content');

        try {
            const data = await getGitHubStats();

            if (!data) {
                if (loading) loading.innerHTML = '<p style="color: var(--text-secondary);">Unable to load GitHub data</p>';
                return;
            }

            // Update stats with animation
            animateNumber(document.getElementById('stat-repos'), data.stats.totalRepos);
            animateNumber(document.getElementById('stat-stars'), data.stats.totalStars);
            animateNumber(document.getElementById('stat-followers'), data.stats.followers);
            animateNumber(document.getElementById('stat-commits'), data.stats.totalCommits || 0);

            // Update streak
            const streakEl = document.getElementById('current-streak');
            if (streakEl) streakEl.textContent = String(data.stats.currentStreak);

            // Render components
            renderLanguages(data.languages);
            renderProjects(data.featuredRepos);
            renderContributions(data.contributionData);

            // Show content
            if (loading) loading.style.display = 'none';
            if (content) content.style.display = 'flex';

            // Animate items with stagger
            setTimeout(() => {
                document.querySelectorAll('.animate-item').forEach((el, index) => {
                    const delay = parseInt(el.getAttribute('data-delay') || '0');
                    setTimeout(() => el.classList.add('visible'), delay + index * 50);
                });
            }, 100);

        } catch (error) {
            console.error('Error loading data:', error);
            if (loading) loading.innerHTML = '<p style="color: var(--text-secondary);">Unable to load data</p>';
        }
    }

    // Intersection Observer for lazy loading
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                loadData();
                observer.unobserve(entry.target);
            }
        });
    }, { threshold: 0.1 });

    const section = document.getElementById('tech');
    if (section) observer.observe(section);
</script>
